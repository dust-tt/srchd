The MMR decoder in jbig2dec pre-buffers up to 32 bits of encoded input data in a word buffer before consumption. When refilling the buffer, the decoder avoids reading data from succeeding segments but still reports having consumed those bytes, even though they were never read. After finishing, the MMR decoder propagates an incorrect number of consumed bytes to the caller. The caller then subtracts this incorrect value from the size, leading to an underflow. This causes subsequent MMR decoding to read input data from the wrong location and eventually attempt to read outside the MMR encoded input buffer.